---
title: "flexdashboard + shiny_prerendered"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    source_code: embed
runtime: shiny
---

```{r setup, include=FALSE}
library(flexdashboard)
library(shiny)
library(ggplot2)
library(dplyr)
library(DT)
blotter_data <- read.csv("Blotter_Data_Archive.csv", header = T) %>% sample_frac(., 0.2)
blotter_data$INCIDENTTIME <- strptime(x = as.character(blotter_data$INCIDENTTIME),
                                      format = "%Y-%m-%dT%H:%M:%S") #From factor to datetime
blotter_data$time <- format(blotter_data$INCIDENTTIME, "%H:%M:%S") #From datetime to character
blotter_data$time <- as.POSIXct(x = blotter_data$time, format = "%H:%M:%S") #From character to continuous time var
blotter_data$date <- format(blotter_data$INCIDENTTIME, "%m-%d")
blotter_data$date <- as.POSIXct(x = blotter_data$date, format = "%m-%d")
blotter_data$type <- cut(blotter_data$HIERARCHY, c(-Inf, 9, 98, Inf), labels = c("Type 1 - Major Crime", "Type 2 - Minor Crime", "No Data"))
blotter_data$INCIDENTTIME <- as.POSIXct(blotter_data$INCIDENTTIME) #to avoid POSIXlt error
neighborhoods <- sort(unique(blotter_data$INCIDENTNEIGHBORHOOD))
```

Inputs {.sidebar}
-----------------------------------------------------------------------

```{r}
#City council district input
 checkboxGroupInput(inputId = "selected_districts",
                    label = "Select Council District(s)",
                    choices = c(1:9),
                    selected = c(1:9)
)

#date range input
dateRangeInput(inputId = "date_range",
               label = "Date Range: yyyy-mm-dd",
               start = "2009-01-01",
               end = "2019-01-01",
               startview = "year")

#Neighborhood selection, adjusted from https://stackoverflow.com/questions/24916115/select-deselect-all-button-for-shiny-variable-selection
radioButtons(
  inputId="radio",
  label="Neighborhood Selection Type:",
  choices=list(
    "All",
    "Manual Select"
  ),
  selected="All")

#If manual selection used above, give neighborhood options
conditionalPanel(
  condition = "input.radio != 'All'",
  checkboxGroupInput(
    'neighborhoods', 
    'Neighborhoods to Show:',
    choices= neighborhoods, 
    selected = c("Central Oakland", "Shadyside", "Squirrel Hill North", "Squirrel Hill South")
  )
)
```

Column {.tabset}
-----------------------------------------------------------------------

### Chart B

```{r}

```

### Chart C

```{r}

```

